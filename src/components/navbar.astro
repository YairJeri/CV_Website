---
import type { Translations } from "../i18n/en";
import { getLanguageNames } from "../i18n";
import LanguageChange from "./language_change.astro";
import { Icon } from "astro-icon/components";

export interface Props {
    lang: string;
    t: Translations;
    socialLinks: Array<{ href: string; label: string; icon: string }>;
}

const { lang, t, socialLinks } = Astro.props;
const navItems = [
    { href: "/" + lang + "/#Home", label: t.navbar.home, icon: "home" },
    { href: "/" + lang + "/#About", label: t.navbar.about, icon: "about" },
    {
        href: "/" + lang + "/#Skills",
        label: t.navbar.skills,
        icon: "skills",
    },
    {
        href: "/" + lang + "/#Portfolio",
        label: t.navbar.portfolio,
        icon: "portfolio",
    },
    // { href: "/#Resume", label: "Resume", icon: "/resume.svg" },
    {
        href: "/" + lang + "/#Contact",
        label: t.navbar.contact,
        icon: "contact",
    },
];

const languages = getLanguageNames();
---

<span
    id="menu-btn-close"
    class="fixed lg:hidden z-50 top-4 right-4 w-10 h-10 bg-accent rounded-full flex items-center justify-center cursor-pointer opacity-0 scale-90 pointer-events-none transition-all duration-300"
>
    <Icon name="close" size={16} class="text-contrast" />
</span>

<span
    id="menu-btn"
    class="fixed lg:hidden z-50 top-4 right-4 w-10 h-10 bg-accent rounded-full flex items-center justify-center cursor-pointer opacity-100 scale-100 transition-all duration-300"
>
    <Icon id="menu-btn" name="menu" size={16} class="text-contrast" />
</span>

<header
    id="menu"
    class="flex overflow-visible flex-col justify-center fixed top-1/2 lg:left-0 -left-full -translate-y-1/2 w-[300px] z-50 py-0 px-4 text-default transition-all duration-300 ease-in-out"
>
    <div
        class="flex flex-col items-center p-4 rounded-3xl bg-surface border-2 border-default/20"
    >
        <nav class="w-full p-0">
            {
                navItems.map((item, index) => (
                    <ul class="flex items-center w-full py-4 px-2.5 text-lg font-normal font-nav text-nav whitespace-nowrap duration-300">
                        <a
                            href={item.href}
                            class="group mr-2.5 text-xl hover:text-nav-hover active:text-nav-hover active:hover:text-nav-hover duration-300"
                        >
                            <Icon
                                name={item.icon}
                                size={24}
                                class="mr-2.5 w-6 h-6 inline-block text-default group-hover:text-nav-hover"
                            />
                            {item.label}
                        </a>
                    </ul>
                ))
            }
        </nav>

        <div class="text-center">
            {
                socialLinks.map((item, index) => (
                    <a
                        href={item.href}
                        target="_blank"
                        class="group inline-flex items-center 
                        justify-center w-12 h-12 my-0 mx-0.5 text-lg
                         text-default rounded-4xl bg-default/10 duration-300
                         hover:text-contrast hover:bg-accent"
                    >
                        <Icon name={item.icon} size={32} />
                    </a>
                ))
            }
        </div>
        <div class="mt-6 relative w-full overflow-visible">
            <LanguageChange lang={lang} languages={languages} />
        </div>
    </div>
    <script type="module">
        let isOpen = false;
        const btnClose = document.getElementById("menu-btn-close");
        const btn = document.getElementById("menu-btn");
        const menu = document.getElementById("menu");

        const toggleButton = (showBtn, hideBtn) => {
            showBtn.classList.remove(
                "opacity-0",
                "scale-90",
                "pointer-events-none",
            );
            showBtn.classList.add("opacity-100", "scale-100");

            hideBtn.classList.remove("opacity-100", "scale-100");
            hideBtn.classList.add(
                "opacity-0",
                "scale-90",
                "pointer-events-none",
            );
        };

        btn.addEventListener("click", () => {
            menu.classList.toggle("-left-full");
            menu.classList.toggle("left-0");
            toggleButton(btnClose, btn);
        });

        btnClose.addEventListener("click", () => {
            menu.classList.toggle("-left-full");
            menu.classList.toggle("left-0");
            toggleButton(btn, btnClose);
        });
    </script>
</header>
